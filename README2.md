# בקשת סוכנות רכב - תיעוד טכני

תוכן עניינים
1. [סקירת פרויקט](#סקירת-פרויקט)
2. [אדריכלות](#אדריכלות)
3. [מבנה נתונים](#מבנה-נתונים)
4. [שילוב API](#integration-api)
5. [מערכת מרובת דיירים](#מערכת-רב-דיירים)
6. [ניהול תוכן](#ניהול-תוכן)
7. [אבטחה](#אבטחה)
8. [הגדרת פיתוח](#הגדרת-פיתוח)
9. [פריסה](#פריסה)

## סקירת הפרויקט

זוהי פלטפורמה מקיפה לסוכנויות רכב הבנויה באמצעות Next.js, הכוללת ארכיטקטורה מרובת משתמשים שבה כל סוכנות פועלת באופן עצמאי תוך שיתוף תוכן משותף. הפלטפורמה תומכת במספר שפות, עדכונים בזמן אמת ומערכת ניהול תוכן חזקה.

### תכונות עיקריות
- ארכיטקטורה מרובת דיירים
- תמיכה בריבוי שפות
- ניהול מלאי בזמן אמת
- מערכת ניהול תוכן
- שירותים וחלפים ספציפיים לחנות
- מערכת מאמרים גלובלית
- אימות והרשאה של משתמשים
- ניהול הזמנות
- אנליטיקה ודיווח

## אדריכלות

רכיבי מערכת

1. **VPC ראשי (64.227.112.249:1337)**
   - מופע סנטרל סטרפי
   - ניהול תוכן גלובלי
   - רישום חנות
   - שירות אימות
   - ניהול מאמרים

2. **VPCs ספציפיים לחנות (טיפות אוקיינוס דיגיטליות)**
   - מקרים בודדים של Strapi
   - מסדי נתונים ספציפיים לחנות
   - שירותים וחלקים מבודדים
   - ניהול הזמנות עצמאי
   - תצורות מותאמות אישית

### ערימת טכנולוגיה
כתב יד מודפס
{
  ממשק קצה: {
    מסגרת: "Next.js 14",
    שפה: "TypeScript",
    עיצוב: "CSS של Tailwind",
    ניהול state: "הקשר מגיב",
    i18n: "הבא בינלאומי"
  },
  קצה אחורי: {
    cms: "סטרפי",
    מסד נתונים: "PostgreSQL",
    api: "מנוחה",
    אימות: "JWT"
  },
  תשתית: {
    אירוח: "DigitalOcean",
    vpc: "מספר VPCs",
    אחסון: "מרחבי אוקיינוס דיגיטלי"
  }
}
```

מבנה נתונים

### 1. מסד נתונים מרכזי (VPC ראשי)

כתב יד מודפס
ממשק StoreRegistry {
  מזהה: מספר;
  שם: מחרוזת;
  שם מארח: מחרוזת;
  אסימון api: מחרוזת;
  שבלול: מחרוזת;
  תצורה: {
    נושא: מחרוזת;
    תכונות: מחרוזת[];
    הגדרות: אובייקט;
  };
  סטטוס: 'פעיל' | 'לא פעיל';
  נוצר בתאריך: תאריך;
  עודכן בתאריך: תאריך;
}

מאמר ממשק {
  מזהה: מחרוזת;
  כותרת: מחרוזת;
  קטע: מחרוזת;
  כריכה: { כתובת אתר: מחרוזת };
  קטגוריות: מערך<{ שם: מחרוזת }>;
  פורסם ב: מחרוזת;
  מחבר: {
    נתונים: {
      תכונות: {
        שם: מחרוזת;
        דוא"ל: מחרוזת;
      };
    };
  };
  תיאור: מחרוזת;
  אזור: מחרוזת;
  שבלול: מחרוזת;
  בלוקים: כל אחד[];
}
```

### 2. מסד נתונים ספציפי לחנות (כל VPC)

כתב יד מודפס
ממשק אחסון מסד נתונים {
  חלקים: {
    מזהה: מספר;
    שם: מחרוזת;
    מחיר: מספר;
    תיאור: מחרוזת;
    קטגוריה: מחרוזת;
    מלאי: מספר;
    תמונות: מחרוזת[];
    מפרט: אובייקט;
  };
  
  שירותים: {
    מזהה: מספר;
    שם: מחרוזת;
    מחיר: מספר;
    תיאור: מחרוזת;
    קטגוריה: מחרוזת;
    משך: מחרוזת;
    דרישות: מחרוזת[];
  };
  
  מוצרים: {
    מזהה: מספר;
    שם: מחרוזת;
    מחיר: מספר;
    תיאור: מחרוזת;
    קטגוריה: מחרוזת;
    תמונות: מחרוזת[];
    מפרט: אובייקט;
    מלאי: מספר;
  };
  
  פרטי הזמנה: {
    מזהה: מספר;
    מזהה הזמנה: מחרוזת;
    פרטי לקוח: {
      שם: מחרוזת;
      דוא"ל: מחרוזת;
      טלפון: מחרוזת;
      כתובת: אובייקט;
    };
    פריטים: מערך <{
      סוג: 'חלק' | 'שירות' | 'מוצר';
      מזהה: מספר;
      כמות: מספר;
      מחיר: מספר;
    }>;
    סטטוס: 'ממתין' | 'מעובד' | 'הושלם' | 'בוטל';
    מידע על תשלום: אובייקט;
    נוצר בתאריך: תאריך;
    עודכן בתאריך: תאריך;
  };
  
  קטגוריות: {
    מזהה: מספר;
    שם: מחרוזת;
    תיאור: מחרוזת;
    מזהה הורה: מספר | null;
    שבלול: מחרוזת;
  };
}
```

## שילוב API

### 1. ממשק API מרכזי (VPC ראשי)

כתב יד מודפס
// ניהול חנות
GET /api/stores - רשימת כל החנויות
POST /api/stores - צור חנות חדשה
GET /api/stores/:id - קבל פרטי חנות
PUT /api/stores/:id - עדכון חנות
מחק /api/stores/:id - מחיקת חנות

// ניהול מאמרים
GET /api/articles - רשימת מאמרים
POST /api/articles - יצירת מאמר
GET /api/articles/:id - קבל מאמר
PUT /api/articles/:id - עדכון מאמר
מחק /api/articles/:id - מחיקת מאמר

// אימות
POST /api/auth/local/register - רישום משתמש
POST /api/auth/local - כניסה למשתמש
GET /api/users/me - קבל את המשתמש הנוכחי
```

### 2. API ספציפי לחנות (כל VPC)

כתב יד מודפס
// ניהול חלקים
GET /api/parts - רשימת חלקים
POST /api/parts - יצירת חלק
GET /api/parts/:id - קבל חלק
PUT /api/parts/:id - עדכון חלק
מחק /api/parts/:id - מחיקת חלק

// ניהול שירותים
GET /api/services - רשימת שירותים
POST /api/services - יצירת שירות
GET /api/services/:id - קבל שירות
PUT /api/services/:id - שירות עדכונים
מחק /api/services/:id - מחיקת שירות

// ניהול הזמנות
GET /api/orders - רשימת הזמנות
POST /api/orders - יצירת הזמנה
GET /api/orders/:id - קבל הזמנה
PUT /api/orders/:id - עדכון הזמנה
מחק /api/orders/:id - מחיקת הזמנה
```

## מערכת מרובת דיירים

בידוד חנות
- כל חנות פועלת תחת VPC משלה
- מסד נתונים עצמאי לכל חנות
- שירותים וחלקים מבודדים
- תצורות מותאמות אישית לכל חנות
- ניהול הזמנות נפרד

### זרימת נתונים
1. רישום חנות
   כתב יד מודפס
   // 1. הרשמה במסד הנתונים המרכזי
   POST /api/stores
   {
     שם: מחרוזת;
     שם מארח: מחרוזת;
     אסימון api: מחרוזת;
     שבלול: מחרוזת;
   }

   // 2. אתחול VPC של החנות
   - צור טיפת DigitalOcean
   - הגדר מופע של Strapi
   - הגדרת מסד נתונים
   - הגדרת טבלאות ספציפיות לחנות
   ```

2. תצורת חנות
   כתב יד מודפס
   // מבנה תצורת החנות
   ממשק אחסון תצורה {
     מסד נתונים: {
       מארח: מחרוזת;
       יציאה: מספר;
       שם: מחרוזת;
       משתמש: מחרוזת;
       סיסמה: מחרוזת;
     };
     api: {
       כתובת בסיס: מחרוזת;
       אסימון: מחרוזת;
     };
     תכונות: מחרוזת[];
     נושא: חפץ;
     הגדרות: אובייקט;
   }
   ```

## ניהול תוכן

### תוכן גלובלי (VPC ראשי)
- מאמרים
חדשות
- פוסטים בבלוג
- הכרזות גלובליות
- מדיה משותפת

### תוכן ספציפי לחנות (כל VPC)
- קטלוג חלקים
- רשימת שירותים
- מלאי מוצרים
- מדיה ספציפית לחנות
- דפים מותאמים אישית

## אבטחה

אימות
כתב יד מודפס
// אימות מבוסס JWT
ממשק AuthConfig {
  אסימון: מחרוזת;
  תפוגה ב: מחרוזת;
  אסימון רענון: מחרוזת;
}

// אבטחת API
ממשק APISecurity {
  שיעורגבול: מספר;
  קור: {
    מקור: מחרוזת[];
    שיטות: מחרוזת[];
  };
  כותרות: {
    'סוג-תוכן': מחרוזת;
    'אישור': מחרוזת;
  };
}
```

### הגנת מידע
בידוד VPC
- הצפנת מסד נתונים
- אימות אסימון API
- בקרת גישה מבוססת תפקידים
- אחסון קבצים מאובטח

## הגדרת פיתוח

דרישות קדם
- Node.js 18+
- PostgreSQL 13+
- חשבון DigitalOcean
- Strapi CLI

### התקנה
באש
# מאגר משוכפל
שיבוט של git [כתובת אתר של מאגר]

# התקנת תלויות
התקנת npm

# הגדרת משתני סביבה
cp .env.example .env

# הפעלת שרת פיתוח
מפתח הפעלה של npm
```

משתני סביבה
מעטפה
# VPC ראשי
NEXT_PUBLIC_STRAPI_URL=http://64.227.112.249:1337
NEXT_PUBLIC_STRAPI_TOKEN=האסימון_שלך

# תצורת חנות
STORE_DATABASE_URL=postgresql://user:password@host:port/database
STORE_API_TOKEN=אסימון_החנות_שלך

# אימות
JWT_SECRET=הסוד_שלך_jwt
```

## פריסה

### פריסת VPC ראשית
1. הגדר את טיפת DigitalOcean
2. התקנת Strapi
3. הגדרת PostgreSQL
4. הגדרת משתני סביבה
5. פריסת אפליקציה

פריסת VPC של חנות
1. צור טיפת DigitalOcean חדשה
2. התקנת Strapi
3. הגדרת מסד נתונים ספציפי לחנות
4. הגדרת תצורת החנות
5. פריסת מופע חנות

### גיבוי ושחזור
כתב יד מודפס
// תהליך הגיבוי
ממשק גיבוי תצורה {
  לוח זמנים: מחרוזת;
  שמירה: מספר;
  מיקום: מחרוזת;
  סוג: 'מלא' | 'הדרגתי';
}

// תהליך שחזור
ממשק RestoreConfig {
  מקור: מחרוזת;
  יעד: מחרוזת;
  סוג: 'מלא' | 'חלקי';
  אפשרויות: אובייקט;
}
```

## מידע נוסף

### אופטימיזציה של ביצועים
- אינדוקס מסד נתונים
- אסטרטגיות אחסון במטמון
- אינטגרציה של CDN
- איזון עומסים
- אופטימיזציה של שאילתות

### ניטור
- מעקב אחר שגיאות
- מדדי ביצועים
- ניתוח משתמשים
- בדיקות תקינות המערכת
- ניצול משאבים

תחזוקה
גיבויים קבועים
- עדכוני אבטחה
- אופטימיזציה של ביצועים
- תחזוקת מסד נתונים
- עדכוני מערכת

תיעוד זה מספק סקירה מקיפה של הארכיטקטורה, פרטי היישום וההיבטים התפעוליים של אפליקציית סוחר הרכב. לפרטי יישום ספציפיים או מידע נוסף, אנא עיינו בקבצי הקוד ובתיעוד המתאימים.


